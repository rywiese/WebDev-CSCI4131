<!DOCTYPE html>
<html>
    <head>
        <!-- Tested Using Mozilla Firefox -->
        <meta charset = "utf-8">
        <link rel="stylesheet" type="text/css" href="style.css">
        <title>My Schedule</title>
        <script type="text/javascript">
            function changeGoldy(image) {
                document.getElementById('goldy').src = image;
            }
            function show(id) {
                document.getElementById(id).style.display = 'inline';
            }
            function hide(id) {
                document.getElementById(id).style.display = 'none';
            }
            var ivl;
            var pictures = ["cive", "keller", "me", "smith"];
            var i = 0;
            function changeSlide() {
                changeGoldy("images/" + pictures[i] + ".jpg");
                i = (i + 1) % 4;
            }
            function startSlideshow() {
                stopSlideshow();
                changeSlide();
                ivl = setInterval(function(){changeSlide()}, 2000);
            }
            function stopSlideshow() {
                clearInterval(ivl);
            }
            var map;
            var markers = [];
            var infowindow;
            var geocoder;
            var campus = {lat: 44.9727, lng: -93.23540000000003};
            function placeMarker(element) {
                var address = element.getElementsByClassName('address')[0].innerHTML;
                var eventName = element.getElementsByClassName('eventName')[0].innerHTML;
                geocoder.geocode( { 'address': address}, function(results, status) {
                    if (status == 'OK') {
                        //map.setCenter(results[0].geometry.location);
                        var icon = {
                            url: 'https://i.imgur.com/WD7TGey.png',
                            scaledSize: new google.maps.Size(50, 50)
                        };
                        var marker = new google.maps.Marker({
                            map: map,
                            position: results[0].geometry.location,
                            icon: icon
                        });
                        var contentString = '<p>' + eventName + '</p>';
                        infowindow = new google.maps.InfoWindow({
                            content: contentString
                        });
                        marker.addListener('click', function() {
                            infowindow.open(map, marker);
                        });
                        markers.push(marker);
                    } else {
                        alert('Geocode was not successful for the following reason: ' + status);
                    }
                });
            }
            function removeMarkers () {
                for(var i = 0; i < markers.length; i++) {
                    markers[i].setMap(null);
                }
                markers.length = 0;
            }
            function initMap() {
                // The map, centered at Uluru
                map = new google.maps.Map(
                    document.getElementById('map'), {zoom: 14, center: campus});
                // The marker, positioned at Uluru
                //var marker = new google.maps.Marker({position: campus, map: map});
                geocoder = new google.maps.Geocoder();
                placeMarker(document.getElementById('smith'), map);
                placeMarker(document.getElementById('keller'), map);
                placeMarker(document.getElementById('me'), map);
                placeMarker(document.getElementById('cive'), map);
            }
            function itemSelected() {
                var findSelect = document.getElementById("findSelect");
                var val = findSelect.options[findSelect.selectedIndex].value;
                if(val == 'other') {
                    document.getElementById('findInput').disabled = false;
                }
                else {
                    document.getElementById('findInput').disabled = true;
                }
            }
            function createMarker(place) {
                var marker = new google.maps.Marker({
                    map: map,
                    position: place.geometry.location
                });
                markers.push(marker);

                google.maps.event.addListener(marker, 'click', function() {
                    infowindow.setContent(place.name);
                    infowindow.open(map, this);
                });
            }
            function search() {
                removeMarkers();
                var findSelect = document.getElementById("findSelect");
                var type = findSelect.options[findSelect.selectedIndex].value;
                if(type == 'other') {
                    var keyword = document.getElementById('findInput').value;
                    request = {
                        location: campus,
                        radius: document.getElementById('findMeters').value,
                        keyword: keyword
                    };
                }
                else {
                    request = {
                        location: campus,
                        radius: document.getElementById('findMeters').value,
                        type: [type]
                    };
                }

                var service = new google.maps.places.PlacesService(map);
                service.nearbySearch(request, function (results, status) {
                    if (status == google.maps.places.PlacesServiceStatus.OK) {
                        for (var i = 0; i < results.length; i++) {
                            var place = results[i];
                            createMarker(results[i]);
                        }
                    }
                    else {
                        alert('Error');
                    }
                });
            }

        </script>
    </head>
    <body>
        <ul class="nav">
            <li class="nav"><a href="mySchedule.html" class="nav"><p> My Schedule </p></a></li>
            <li class="nav"><a href="myPlaces.html" class="nav"><p> My Favorite Places </p></a></li>
            <li class="nav"><a href="myForm.html" class="nav"><p> Form Input </p></a></li>
            <li class="nav"><a href="myWidgets.html" class="nav"><p> My Widgets </p></a></li>
        </ul>
        <h1 id='head'> My Spring 19 Schedule </h1>
        <div class="goldydiv">
            <img id="goldy" src="images/gophers-mascot.png" alt="Goldy"/>
            <br>
            <button onclick="startSlideshow()">Start</button>
            <button onclick="stopSlideshow()">Stop</button>
        </div>
        <table>
            <tr>
                <td class="day">Mon</td>
                <td>Nothing Scheduled</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="day">Tue</td>
                <td id='smith' onmouseover="show('t4604')" onmouseout="hide('t4604')">
                    <p class="time">9:05 - 11:00 AM</p>
                    <p class='eventName'>MATH 4604 - Smith 121</p>
                    <p class='address'>207 Pleasant St SE, Minneapolis, MN 55455</p>
                    <img id="t4604" class="icon" src="images/smith.jpg" alt="hall"/>
                </td>
                <td id='me' onmouseover="show('t5521')" onmouseout="hide('t5521')">
                    <p class="time">2:30 - 3:45 PM</p>
                    <p class='eventName'>CSCI 5521 - M.E. 212</p>
                    <p class='address'>111 Church St SE, Minneapolis, MN 55455</p>
                    <img id="t5521" class="icon" src="images/me.jpg" alt="hall"/>
                </td>
                <td id='keller' onmouseover="show('4131')" onmouseout="hide('4131')">
                    <p class="time">6:30 - 9:00 PM</p>
                    <p class='eventName'>CSCI 4131 - Keller 3-210</p>
                    <p class='address'>200 Union St SE, Minneapolis, MN 55455</p>
                    <img id="4131" class="icon" src="images/keller.jpg" alt="hall"/>
                </td>
            </tr>
            <tr>
                <td class="day">Wed</td>
                <td onmouseover="show('5421')" onmouseout="hide('5421')">
                    <p class="time">6:30 - 9:00 PM</p>
                    <p>CSCI 5421 - Keller 3-210</p>
                    <p>200 Union St SE, Minneapolis, MN 55455</p>
                    <img id="5421" class="icon" src="images/keller.jpg" alt="hall"/>
                </td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="day">Thu</td>
                <td onmouseover="show('th4604')" onmouseout="hide('th4604')">
                    <p class="time">9:05 - 11:00 AM</p>
                    <p>MATH 4604 - Smith 121</p>
                    <p>207 Pleasant St SE, Minneapolis, MN 55455</p>
                    <img id="th4604" class="icon" src="images/smith.jpg" alt="hall"/>
                </td>
                <td id='cive' onmouseover="show('2011')" onmouseout="hide('2011')">
                    <p class="time">1:25 - 2:15 PM</p>
                    <p class='eventName'>CSCI 2011H (TA) - Civ E 212</p>
                    <p class='address'>500 Pillsbury Dr SE, Minneapolis, MN 55455</p>
                    <img id="2011" class="icon" src="images/cive.jpg" alt="hall"/>
                </td>
                <td onmouseover="show('th5521')" onmouseout="hide('th5521')">
                    <p class="time">2:30 - 3:45 PM</p>
                    <p>CSCI 5521 - M.E. 212</p>
                    <p>111 Church St SE, Minneapolis, MN 55455</p>
                    <img id="th5521" class="icon" src="images/me.jpg" alt="hall"/>
                </td>
            </tr>
            <tr>
                <td class="day">Fri</td>
                <td onmouseover="show('meeting')" onmouseout="hide('meeting')">
                    <p class="time">11:00 - 12:00 PM</p>
                    <p>TA Meeting - Keller Hall</p>
                    <p>200 Union St SE, Minneapolis, MN 55455</p>
                    <img id="meeting" class="icon" src="images/keller.jpg" alt="hall"/>
                </td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="day">Sat</td>
                <td>Nothing Scheduled</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="day">Sun</td>
                <td>Nothing Scheduled</td>
                <td></td>
                <td></td>
            </tr>
        </table>
        <div id='mapAndForm'>
            <div id="map"></div>
            <div class='form' id="mapForm" >
                <form name='mapForm' method='post' onsubmit="search();return false;">
                    <div class='formItem'>
                        <label>Find:</label>
                        <select id="findSelect" name="findSelect" onchange="itemSelected();">
                            <option value="restaurant">Restaurant</option>
                            <option value="hospital">Hospital</option>
                            <option value="parking">Parking</option>
                            <option value="library">Library</option>
                            <option value="other">Other</option>
                        </select>
                        <br>
                        <label></label>
                        <input id='findInput' type='text' placeholder="Enter a keyword" disabled>
                        <br>
                        <label>within:</label>
                        <input id='findMeters' type='text' value=500 required>
                        <label>meters</label>
                        <input type='submit' value='Search'>
                    </div>
                </form>
            </div>
        </div>
        <script>
            <span class="metadata-marker" style="display: none;" data-region_tag="script-body"></span>// Initialize and add the map
        </script>
        <!--Load the API from the specified URL
        * The async attribute allows the browser to render the page while the API loads
        * The key parameter will contain your own API key (which is not needed for this tutorial)
        * The callback parameter executes the initMap() function
        -->
        <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=MY_KEY&libraries=places&callback=initMap">
        </script>
    </body>
</html>
